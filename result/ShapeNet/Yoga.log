parse arguments succeed !!!
300 1 426
start new network training
train encoder
batch time:  0.4043772886196772
batch time:  0.390755261387676
batch time:  0.36670235039976734
batch time:  0.43320278348401187
batch time:  0.3346106498502195
batch time:  0.38932537383710347
epoch 0 loss:  27.37774981505988
epoch 0 time:  2.3195117756569137
batch time:  0.4975168585311621
batch time:  0.39170319157031674
batch time:  0.3977306766745945
batch time:  0.3899865802067021
batch time:  0.41350023238919675
batch time:  0.42952718324959277
epoch 1 loss:  10.28276612477201
epoch 1 time:  2.5208220070848864
batch time:  0.3783539666949461
batch time:  0.39468830881329875
batch time:  0.32933450347433485
batch time:  0.3530718643839161
batch time:  0.39118532110005616
batch time:  0.36868638048569363
epoch 2 loss:  3.7733190488595443
epoch 2 time:  2.216084353765473
batch time:  0.3552091285120696
batch time:  0.36498441284832855
batch time:  0.37342316162151595
batch time:  0.336388762962694
batch time:  0.3361886794057985
batch time:  0.36743160992239915
epoch 3 loss:  -0.563191492571478
epoch 3 time:  2.134304390847683
batch time:  0.40518677231545247
batch time:  0.3708172357951601
batch time:  0.3684715479767571
batch time:  0.3407797200450053
batch time:  0.3856737143204858
batch time:  0.36928554583961765
epoch 4 loss:  -3.9004719546572675
epoch 4 time:  2.2407957021457454
batch time:  0.4244091084537407
batch time:  0.3363808202712486
batch time:  0.4050559928019842
batch time:  0.36911616581492124
batch time:  0.39087167792022226
batch time:  0.41172465377797685
epoch 5 loss:  -5.549984591720439
epoch 5 time:  2.3382992630669226
batch time:  0.36572157096428176
batch time:  0.3591818334069103
batch time:  0.3959535753975312
batch time:  0.3696563306264579
batch time:  0.34148236494511364
batch time:  0.44063931453662614
epoch 6 loss:  -6.6272531444872
epoch 6 time:  2.2733069423896572
batch time:  0.40832294171365596
batch time:  0.43030539476312696
batch time:  0.40125595446055135
batch time:  0.3666091683786362
batch time:  0.37185878404416145
batch time:  0.3754415552131832
epoch 7 loss:  -8.954231681062833
epoch 7 time:  2.354548153731351
batch time:  0.41554842501257855
batch time:  0.41600172330314916
batch time:  0.3716641390385727
batch time:  0.3518835297164818
batch time:  0.3352253198468437
batch time:  0.3999106494554629
epoch 8 loss:  -9.754852502986772
epoch 8 time:  2.2908600696052113
batch time:  0.36811565308210753
batch time:  0.3714150367459903
batch time:  0.33805315412270526
batch time:  0.37091314159333705
batch time:  0.41263596004185576
batch time:  0.3708079276606441
epoch 9 loss:  -9.698684976354208
epoch 9 time:  2.2325548741966488
batch time:  0.3847785283966611
batch time:  0.3543150961554299
batch time:  0.3735248439324399
batch time:  0.3562202096140633
batch time:  0.34563645338639615
batch time:  0.4032630647843083
epoch 10 loss:  -11.06187864695947
epoch 10 time:  2.218240994416798
batch time:  0.36511906938006483
batch time:  0.36716890822475157
batch time:  0.40017913390571874
batch time:  0.35241650296375154
batch time:  0.37919635251164435
batch time:  0.34993097808522483
epoch 11 loss:  -9.094845384512164
epoch 11 time:  2.214372137670095
batch time:  0.36790859675966203
batch time:  0.3769990955479443
batch time:  0.40595564637333154
batch time:  0.36721382463971775
batch time:  0.3431866081741949
batch time:  0.41691437889821825
epoch 12 loss:  -11.942123992435658
epoch 12 time:  2.278646657491724
batch time:  0.372817457622538
batch time:  0.39548607255953055
batch time:  0.3527235840447247
batch time:  0.4133017327791701
batch time:  0.40390503817858797
batch time:  0.37675089398399
epoch 13 loss:  -12.109621751594624
epoch 13 time:  2.3153890514901527
batch time:  0.43349310470124086
batch time:  0.3852405492371569
batch time:  0.41336847917797664
batch time:  0.431189972627908
batch time:  0.3359179117716849
batch time:  0.38894029272099334
epoch 14 loss:  -12.138702476056174
epoch 14 time:  2.388618482230231
batch time:  0.4274760684929788
batch time:  0.3840826917129258
batch time:  0.33798434366472063
batch time:  0.335616952382649
batch time:  0.34467432131059467
batch time:  0.33309730120624104
epoch 15 loss:  -12.385446346768056
epoch 15 time:  2.1633835576319447
batch time:  0.37855449691414833
batch time:  0.3717101147243132
batch time:  0.34596838750876485
batch time:  0.35357592697255313
batch time:  0.3895908437669277
batch time:  0.38751098536886275
epoch 16 loss:  -12.610609236720245
epoch 16 time:  2.2272090553461266
batch time:  0.4230126780613015
batch time:  0.3527873200364411
batch time:  0.3985360535948227
batch time:  0.3622012483111272
batch time:  0.38672465317261717
batch time:  0.3817739598763486
epoch 17 loss:  -11.050722328472395
epoch 17 time:  2.3055600371211766
batch time:  0.40484801755907635
batch time:  0.34134373391668
batch time:  0.4335976023226976
batch time:  0.40819838556150595
batch time:  0.38475833943424126
batch time:  0.33503113039769233
epoch 18 loss:  -12.922980350998046
epoch 18 time:  2.308229754927258
batch time:  0.37189924746441344
batch time:  0.37122812195060156
batch time:  0.3517378333490342
batch time:  0.39476680642304324
batch time:  0.3756256860991319
batch time:  0.37763536513472595
epoch 19 loss:  -12.676146941119601
epoch 19 time:  2.243306434045856
batch time:  0.36193961738608776
batch time:  0.3694235109103223
batch time:  0.3663890250337621
batch time:  0.43268020305161675
batch time:  0.3519759369237969
batch time:  0.391392002797996
epoch 20 loss:  -12.912981227411434
epoch 20 time:  2.2742812053921324
batch time:  0.3922099898879727
batch time:  0.3349585854448378
batch time:  0.3891559355892241
batch time:  0.333594867043818
batch time:  0.4231973994523287
batch time:  0.3959122657154997
epoch 21 loss:  -12.9944406212649
epoch 21 time:  2.2695317547457914
batch time:  0.35765708959661424
batch time:  0.3611730167642236
batch time:  0.39345057600488265
batch time:  0.33423758132072784
batch time:  0.40631649709927536
batch time:  0.4267221841805925
epoch 22 loss:  -13.228525041219331
epoch 22 time:  2.2800422851306696
batch time:  0.39083919549981755
batch time:  0.36636460839460294
batch time:  0.4179030473188808
batch time:  0.33977340172665815
batch time:  0.4115841187536716
batch time:  0.41410313492330414
epoch 23 loss:  -12.927498521535714
epoch 23 time:  2.341034828995665
batch time:  0.4132726301128666
batch time:  0.3369820103359719
batch time:  0.3780939174195131
batch time:  0.3841190044923375
batch time:  0.3785702275733153
batch time:  0.38803322915919125
epoch 24 loss:  -13.412435634336347
epoch 24 time:  2.2795905620791017
batch time:  0.3539661287485311
batch time:  0.40650439526264864
batch time:  0.4127538955459992
batch time:  0.3793832695732514
batch time:  0.386004418383042
batch time:  0.39178536282852294
epoch 25 loss:  -12.727564803581007
epoch 25 time:  2.3309701721339176
batch time:  0.33725129060136777
batch time:  0.3982301303651184
batch time:  0.3462087282910943
batch time:  0.3384252625517547
batch time:  0.3280143221685042
batch time:  0.3369932939764112
epoch 26 loss:  -13.117710687997928
epoch 26 time:  2.085663824590544
batch time:  0.3317998978930215
batch time:  0.330429557695364
batch time:  0.32847584596214197
batch time:  0.3269065889219443
batch time:  0.3377787824409703
batch time:  0.3334543115148942
epoch 27 loss:  -12.656804686378235
epoch 27 time:  1.989338360230128
batch time:  0.33373238540564976
batch time:  0.3280484839497755
batch time:  0.32618680158630015
batch time:  0.3231960925584038
batch time:  0.3267099869127075
batch time:  0.3227478331420571
epoch 28 loss:  -13.302428663776325
epoch 28 time:  1.9608819148658465
batch time:  0.32637166844991344
batch time:  0.32755728126503525
batch time:  0.3245330632353822
batch time:  0.3285013242935141
batch time:  0.32642260248151916
batch time:  0.3292994423614194
epoch 29 loss:  -13.299539832742962
epoch 29 time:  1.9633253729746987
encode time:  67.36613377613637

Start sliding the raw time series and the corresponding class and variate label
0
X_slide shape: (13200, 255)
candidates_dim: (13200, 255)
candidates_class_label: (13200, 255)
batch number:  264
count:  0
count:  100
count:  200
representation_all shape: (13200, 320)
1
X_slide shape: (19500, 170)
candidates_dim: (19500, 170)
candidates_class_label: (19500, 170)
batch number:  390
count:  0
count:  100
count:  200
count:  300
representation_all shape: (32700, 320)
2
X_slide shape: (26100, 85)
candidates_dim: (26100, 85)
candidates_class_label: (26100, 85)
batch number:  522
count:  0
count:  100
count:  200
count:  300
count:  400
count:  500
representation_all shape: (58800, 320)
End sliding
siding time:  0.5520781179579596

* All the shapelets info:
(58800, 320)
58800
(58800,)
all subTs num: [13200, 19500, 26100]

Start clustring all the new representations...
End clustring
clustring time: 2.9842426508975524

calculate elements number in each cluster
time: 0.3499724864959717

get the nearest index
time: 0.5830514430999756

Start scoring all the candidate...
End scoring
discovery time:  3.5564214810263364
transformation time:  0.2758321824328353
classification time:  0.004313647948826353
svm linear Accuracy: 0.5356666666666666
/home/lmeiyao/.conda/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

           1       0.00      0.00      0.00      1393
           2       0.54      1.00      0.70      1607

    accuracy                           0.54      3000
   macro avg       0.27      0.50      0.35      3000
weighted avg       0.29      0.54      0.37      3000

All time:  76.74300066257517
