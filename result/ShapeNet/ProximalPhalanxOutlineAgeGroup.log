parse arguments succeed !!!
400 1 80
start new network training
train encoder
batch time:  0.32562474803999064
batch time:  0.33621081806098424
batch time:  0.33400253183208406
batch time:  0.329163232864812
batch time:  0.29437677540505924
batch time:  0.34800308506625394
batch time:  0.34439250150074563
batch time:  0.3731089965750774
epoch 0 loss:  4.8753106681356915
epoch 0 time:  2.685361196426675
batch time:  0.3296951145709803
batch time:  0.31075305143992105
batch time:  0.30742926985646285
batch time:  0.3192983090567092
batch time:  0.3541061415026585
batch time:  0.3595888891723007
batch time:  0.32633191922989985
batch time:  0.30068837261448306
epoch 1 loss:  -2.7224230076863387
epoch 1 time:  2.608705145586282
batch time:  0.30255064233206214
batch time:  0.3350815540800492
batch time:  0.373493263265118
batch time:  0.34591810350927216
batch time:  0.29798983153887093
batch time:  0.28783940131155156
batch time:  0.33962510658117634
batch time:  0.32312155951124927
epoch 2 loss:  -6.009032236042697
epoch 2 time:  2.606460071836288
batch time:  0.3096247505086164
batch time:  0.31032943362370136
batch time:  0.3019312896610548
batch time:  0.35021477900445463
batch time:  0.3636561816558242
batch time:  0.33274915226114293
batch time:  0.309134473434339
batch time:  0.28442546621275444
epoch 3 loss:  -7.880214504929014
epoch 3 time:  2.5628448818965506
batch time:  0.33342622250008086
batch time:  0.36330002881586554
batch time:  0.33409698981170854
batch time:  0.29951450978405775
batch time:  0.30133135287712015
batch time:  0.33668122423502306
batch time:  0.3387749151326716
batch time:  0.333325928915292
epoch 4 loss:  -8.826418379821977
epoch 4 time:  2.64100631767263
batch time:  0.30060740251404544
batch time:  0.3089671246086558
batch time:  0.3326682385057211
batch time:  0.35531496584104993
batch time:  0.33384914010142286
batch time:  0.32791242088812095
batch time:  0.30032688725429274
batch time:  0.3262053885186712
epoch 5 loss:  -11.924285981854151
epoch 5 time:  2.586813481353844
batch time:  0.41170887821353974
batch time:  0.31270255975735683
batch time:  0.4642506818131854
batch time:  0.37604920046093565
batch time:  0.4321256346379717
batch time:  0.3135634482062111
batch time:  0.4100585153171172
batch time:  0.44733851586158074
epoch 6 loss:  -12.469247734421796
epoch 6 time:  3.168497628470262
batch time:  0.3172746813235184
batch time:  0.40415536393411455
batch time:  0.329001988718907
batch time:  0.3405940220846484
batch time:  0.3421607942475627
batch time:  0.39663991297905643
batch time:  0.3250493129404883
batch time:  0.364281884363542
epoch 7 loss:  -7.727211164502206
epoch 7 time:  2.819926372729242
batch time:  0.3042912440064053
batch time:  0.38927873484790326
batch time:  0.32490371336850027
batch time:  0.3855916512198746
batch time:  0.4007484040067842
batch time:  0.44090521074831485
batch time:  0.35746017515969775
batch time:  0.4453032271626095
epoch 8 loss:  -10.659696222834212
epoch 8 time:  3.049243971115599
batch time:  0.4228664218603323
batch time:  0.42518695518374444
batch time:  0.43991868078398205
batch time:  0.3396633784441898
batch time:  0.38527362562405565
batch time:  0.3590718245599419
batch time:  0.3999860848144939
batch time:  0.3323903064864377
epoch 9 loss:  -12.777251664469961
epoch 9 time:  3.1055691523322215
batch time:  0.39271176972736915
batch time:  0.3265035103075206
batch time:  0.36035957912293576
batch time:  0.32670995785544316
batch time:  0.3962614026696732
batch time:  0.3399015986205389
batch time:  0.3952545738623788
batch time:  0.3449854180061569
epoch 10 loss:  -12.79784290714435
epoch 10 time:  2.8834218110733976
batch time:  0.3834305317296336
batch time:  0.3304678194845716
batch time:  0.4199417379995187
batch time:  0.33827646837259334
batch time:  0.4447535392983506
batch time:  0.3617090225995829
batch time:  0.4117996062152088
batch time:  0.319895036239177
epoch 11 loss:  -14.706428217580104
epoch 11 time:  3.0108279183972626
batch time:  0.454480292648077
batch time:  0.4446412111166865
batch time:  0.3276587647385895
batch time:  0.40013336421300966
batch time:  0.3168442785429458
batch time:  0.37778263942648965
batch time:  0.3136470222069571
batch time:  0.38093709919291235
epoch 12 loss:  -14.821860380833533
epoch 12 time:  3.01703746637019
batch time:  0.32574476138688624
batch time:  0.3697050412806372
batch time:  0.34906218488079804
batch time:  0.34900622521527114
batch time:  0.3813599263783544
batch time:  0.4138808415426562
batch time:  0.35975486252767347
batch time:  0.4028411556656162
epoch 13 loss:  -14.84118138189152
epoch 13 time:  2.952195071134095
batch time:  0.31926414327075087
batch time:  0.347012155658255
batch time:  0.34453478720970454
batch time:  0.35975402730206646
batch time:  0.3470108611664424
batch time:  0.37386792260222135
batch time:  0.32079677493311465
batch time:  0.3889104286208749
epoch 14 loss:  -13.433352667096766
epoch 14 time:  2.802131376415491
batch time:  0.411759906867519
batch time:  0.4239823132287711
batch time:  0.3996068491290013
batch time:  0.3249910296561817
batch time:  0.39708897075615823
batch time:  0.3514972974701474
batch time:  0.3843180787904809
batch time:  0.3492984119337052
epoch 15 loss:  -15.967699427028856
epoch 15 time:  3.0434110272520534
batch time:  0.43048529929171003
batch time:  0.42029008114089567
batch time:  0.4392976169474423
batch time:  0.3657330791310718
batch time:  0.39584150494386755
batch time:  0.4316448664137473
batch time:  0.32212138439839083
batch time:  0.373707182208697
epoch 16 loss:  -9.316641032788976
epoch 16 time:  3.1799828556055822
batch time:  0.38448132829119763
batch time:  0.3560564766793201
batch time:  0.3767438852849106
batch time:  0.3643709527949492
batch time:  0.3108029521380862
batch time:  0.41024648301924266
batch time:  0.34215454012155533
batch time:  0.37972001476834216
epoch 17 loss:  -11.052795304942913
epoch 17 time:  2.9254385221594323
batch time:  0.3378083841099093
batch time:  0.3977902976796031
batch time:  0.3246765042965611
batch time:  0.391883001010865
batch time:  0.3567162200498084
batch time:  0.374254671499754
batch time:  0.37580474473846454
batch time:  0.43400033524570364
epoch 18 loss:  -17.70169858049004
epoch 18 time:  2.9939264322631063
batch time:  0.36477676865955194
batch time:  0.3425071377617617
batch time:  0.40027784671013555
batch time:  0.37233938335751493
batch time:  0.39819621574133635
batch time:  0.36524992931323746
batch time:  0.39153410665070015
batch time:  0.3574689651839435
epoch 19 loss:  -15.858654694460276
epoch 19 time:  2.99342643370231
batch time:  0.358467756692941
batch time:  0.3483633050850282
batch time:  0.42468004995025693
batch time:  0.3271619657209764
batch time:  0.3499395746892939
batch time:  0.3418592963833362
batch time:  0.3968244826886803
batch time:  0.3801916463455806
epoch 20 loss:  -16.69036631123251
epoch 20 time:  2.928532482373218
batch time:  0.41514183348044753
batch time:  0.34227173565886915
batch time:  0.3717277139580498
batch time:  0.34972705867451925
batch time:  0.33314829305745663
batch time:  0.4347120597182463
batch time:  0.36150446492247285
batch time:  0.4001320864850034
epoch 21 loss:  -16.93288180904328
epoch 21 time:  3.0096922057215125
batch time:  0.39142264913146696
batch time:  0.3222455060264717
batch time:  0.4104210414458066
batch time:  0.3233300348743796
batch time:  0.3905215622546772
batch time:  0.3382071970341106
batch time:  0.45724773840047417
batch time:  0.37006812629600366
epoch 22 loss:  -14.567213877564214
epoch 22 time:  3.0045801736724873
batch time:  0.4022433519208183
batch time:  0.3387827598489821
batch time:  0.4179597171333929
batch time:  0.35615108989489574
batch time:  0.4108531730404745
batch time:  0.36385194074052074
batch time:  0.40236344303314886
batch time:  0.39322828060636916
epoch 23 loss:  -16.383602628753653
epoch 23 time:  3.0865312700159846
batch time:  0.3316576751880348
batch time:  0.3736037182155997
batch time:  0.3236354897574832
batch time:  0.3555550473742187
batch time:  0.34421812570653854
batch time:  0.44356686434087655
batch time:  0.34711971576325595
batch time:  0.4175715970030675
epoch 24 loss:  -9.369784464623024
epoch 24 time:  2.9377758814487605
batch time:  0.38836678767887256
batch time:  0.3259359843097627
batch time:  0.39487786165749034
batch time:  0.34197227537321545
batch time:  0.37120276424102483
batch time:  0.3483737397318085
batch time:  0.360202676942572
batch time:  0.3274810911777119
epoch 25 loss:  -14.576690202220906
epoch 25 time:  2.859959520663445
batch time:  0.4158110269966225
batch time:  0.3207861274325599
batch time:  0.39006312568672
batch time:  0.33144127825895947
batch time:  0.4399784824500481
batch time:  0.32498825076036153
batch time:  0.3764353853650391
batch time:  0.3620421185158193
epoch 26 loss:  -16.737747803342376
epoch 26 time:  2.962384256410102
batch time:  0.3708601388769845
batch time:  0.3433208359560619
batch time:  0.36315605815810464
batch time:  0.3302450480250021
batch time:  0.38670049179345367
batch time:  0.33809058054660757
batch time:  0.3821714473888278
batch time:  0.36425367727254826
epoch 27 loss:  -14.830339203028041
epoch 27 time:  2.8795261479138086
batch time:  0.3479858074647685
batch time:  0.3353316756741454
batch time:  0.33826877184522647
batch time:  0.3854662239085883
batch time:  0.40891506847304604
batch time:  0.3418331120163202
batch time:  0.3444389819167554
batch time:  0.3320387951253603
epoch 28 loss:  -17.319088120353854
epoch 28 time:  2.835131494545688
batch time:  0.3788376236024002
batch time:  0.33846459795410433
batch time:  0.39679053497190275
batch time:  0.3931873779433469
batch time:  0.4562285667440544
batch time:  0.3490726381229858
batch time:  0.37603384063889583
batch time:  0.34292045707503954
epoch 29 loss:  -16.07552923462722
epoch 29 time:  3.0323009485378862
encode time:  87.18533547399565

Start sliding the raw time series and the corresponding class and variate label
0
X_slide shape: (6800, 48)
candidates_dim: (6800, 48)
candidates_class_label: (6800, 48)
batch number:  136
count:  0
count:  100
representation_all shape: (6800, 320)
1
X_slide shape: (10000, 32)
candidates_dim: (10000, 32)
candidates_class_label: (10000, 32)
batch number:  200
count:  0
count:  100
representation_all shape: (16800, 320)
2
X_slide shape: (13200, 16)
candidates_dim: (13200, 16)
candidates_class_label: (13200, 16)
batch number:  264
count:  0
count:  100
count:  200
representation_all shape: (30000, 320)
End sliding
siding time:  0.3365813645068556

* All the shapelets info:
(30000, 320)
30000
(30000,)
all subTs num: [6800, 10000, 13200]

Start clustring all the new representations...
End clustring
clustring time: 1.597088315958778

calculate elements number in each cluster
time: 0.4209907054901123

get the nearest index
time: 0.4055001735687256

Start scoring all the candidate...
End scoring
discovery time:  1.9517122716953357
transformation time:  0.06521855642398199
classification time:  0.0001167171634733677
svm linear Accuracy: 0.824390243902439
/home/lmeiyao/.conda/envs/py37/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

           1       0.00      0.00      0.00        17
           2       0.78      0.83      0.80        88
           3       0.86      0.96      0.91       100

    accuracy                           0.82       205
   macro avg       0.55      0.60      0.57       205
weighted avg       0.76      0.82      0.79       205

All time:  89.30841271299869
