parse arguments succeed !!!
500 1 1024
start new network training
train encoder
batch time:  2.2046999314799907
batch time:  2.1595556925361357
batch time:  2.251876547265177
batch time:  2.243670058591912
batch time:  2.1087408693662533
batch time:  2.2001790542931605
batch time:  1.8976089525036515
batch time:  1.9616467111588767
batch time:  2.023444171482697
batch time:  1.8778267100763817
epoch 0 loss:  27.811076221469836
epoch 0 time:  20.930408033014587
batch time:  1.8379838215808073
batch time:  2.6384190308861433
batch time:  2.2988420733405897
batch time:  2.1658019725078095
batch time:  1.748294375728195
batch time:  2.3846366965211927
batch time:  2.523558152761931
batch time:  2.009605952290197
batch time:  2.108923183955873
batch time:  1.8929549264721572
epoch 1 loss:  17.316264927382164
epoch 1 time:  21.61032925139492
batch time:  2.077569184048722
batch time:  2.2934190584967533
batch time:  2.39624172700569
batch time:  1.8818602800524482
batch time:  2.262557062134147
batch time:  2.1172998017786693
batch time:  2.0834666593310733
batch time:  1.8727651150897144
batch time:  1.9074127914384007
batch time:  2.0086821128614245
epoch 2 loss:  6.409532824597111
epoch 2 time:  20.902608717574427
batch time:  2.195618568904077
batch time:  2.054174448673924
batch time:  2.1365907236778487
batch time:  2.5470602805260567
batch time:  2.323928997820864
batch time:  1.9695743255938092
batch time:  2.2773843763706583
batch time:  2.1887596811633556
batch time:  2.0064229327098775
batch time:  1.9621943894928942
epoch 3 loss:  1.001691146011111
epoch 3 time:  21.662566804792732
batch time:  2.5664683228669065
batch time:  2.0854445456061512
batch time:  1.8564287669646242
batch time:  1.9088327380052457
batch time:  1.9684751813299954
batch time:  2.1316808158376563
batch time:  2.0107388491897535
batch time:  2.231994270021096
batch time:  2.120033239107579
batch time:  2.5197363747594257
epoch 4 loss:  -0.026972136035164906
epoch 4 time:  21.400227649882435
batch time:  1.9640207335352897
batch time:  2.1171047194860875
batch time:  2.084156868529196
batch time:  2.207218329468742
batch time:  2.2132092045154423
batch time:  2.1233012977832306
batch time:  2.048425838910043
batch time:  2.1219726936581234
batch time:  1.9730112369327495
batch time:  2.14231470990926
epoch 5 loss:  -3.559146106920795
epoch 5 time:  20.99521628303143
batch time:  1.7386405329064776
batch time:  2.1409894021227958
batch time:  2.0185298126811784
batch time:  1.8758921177281687
batch time:  2.208974616291622
batch time:  1.7746107003496339
batch time:  2.011887265089899
batch time:  2.136979438426594
batch time:  2.0368433475804824
batch time:  2.5315404728675883
epoch 6 loss:  -4.831535535143749
epoch 6 time:  20.475529863343883
batch time:  1.863490983347098
batch time:  2.101081691775471
batch time:  2.2213988174373904
batch time:  2.6586488669893393
batch time:  2.0560249533504247
batch time:  1.8783099694022287
batch time:  1.7951861624140293
batch time:  2.110792277830963
batch time:  2.192282558558509
batch time:  2.2601929754484447
epoch 7 loss:  -5.643374092985019
epoch 7 time:  21.138021181011574
batch time:  2.907880496342356
batch time:  1.9388942878538122
batch time:  2.118662301575144
batch time:  2.0649653220083564
batch time:  1.542859435469533
batch time:  1.8830441886248688
batch time:  1.7919627687893809
batch time:  1.9365903460420668
batch time:  1.9674925187447418
batch time:  2.205471974828591
epoch 8 loss:  -4.467139814441325
epoch 8 time:  20.358181153439606
batch time:  2.076847147149965
batch time:  1.8945246817699324
batch time:  2.0073812303754193
batch time:  2.1349072290429225
batch time:  1.8584753781401864
batch time:  2.129717521338413
batch time:  2.0008936239872126
batch time:  2.2237371755298225
batch time:  1.9501743157394231
batch time:  2.445248413567121
epoch 9 loss:  -7.062295232828053
epoch 9 time:  20.722343372926115
batch time:  1.866042497412612
batch time:  2.013877772198369
batch time:  2.3132193974995365
batch time:  1.9420419379137457
batch time:  1.9519942278197655
batch time:  2.25213108661895
batch time:  1.8805340263682107
batch time:  2.0750611249823123
batch time:  1.8947665203362702
batch time:  1.9855478136645008
epoch 10 loss:  -5.896097639248121
epoch 10 time:  20.175615838123484
batch time:  1.9462690827591966
batch time:  2.003959789732471
batch time:  1.8388407905430844
batch time:  2.1120024145736047
batch time:  1.9640272611596932
batch time:  2.7734400319401176
batch time:  2.375121664907783
batch time:  2.236807505134493
batch time:  1.9030966164699445
batch time:  2.5069883208721877
epoch 11 loss:  -8.784378924144853
epoch 11 time:  21.660978804295883
batch time:  2.2293424075779815
batch time:  2.1051882836191607
batch time:  1.8673499229984978
batch time:  2.834339637619754
batch time:  2.115637494530529
batch time:  1.881472131734093
batch time:  2.3773028288812688
batch time:  1.873445408542951
batch time:  1.8619042384748659
batch time:  2.025623015826568
epoch 12 loss:  -9.57425658788199
epoch 12 time:  21.172042340816308
batch time:  2.462834696394081
batch time:  2.1973663520688813
batch time:  1.650556421512738
batch time:  2.0266570686673124
batch time:  2.086812660253296
batch time:  1.9781729701906443
batch time:  2.247133186987291
batch time:  2.170671615889296
batch time:  1.937344277681162
batch time:  2.1273149635487547
epoch 13 loss:  -9.60481102856009
epoch 13 time:  20.88530778743637
batch time:  1.9847315019927918
batch time:  2.4796675567825637
batch time:  1.8849022214921811
batch time:  2.1676534339475135
batch time:  2.251908721324677
batch time:  2.0660005959216505
batch time:  1.840851230515788
batch time:  2.032772988298287
batch time:  2.13563689365983
batch time:  1.947126676669965
epoch 14 loss:  -10.261794252699707
epoch 14 time:  20.791687482067694
batch time:  2.073403279514362
batch time:  2.058087487254913
batch time:  1.851397195768853
batch time:  2.1220928837855655
batch time:  2.1369781913235784
batch time:  3.4365883469581604
batch time:  3.3167055786897737
batch time:  3.3761160642995187
batch time:  3.699661806396519
batch time:  4.28139939767619
epoch 15 loss:  -10.680922836556794
epoch 15 time:  28.352851912224043
batch time:  3.3854411912771565
batch time:  3.235615149854372
batch time:  1.5834624933699766
batch time:  1.6366484009816
batch time:  1.4084976665986082
batch time:  1.4614843210826318
batch time:  1.5780029526446016
batch time:  1.4478566889185458
batch time:  1.4003182138005892
batch time:  1.4400134609546513
epoch 16 loss:  -9.944507496852282
epoch 16 time:  18.57786796442233
batch time:  1.6441103907612462
batch time:  1.463621616239349
batch time:  1.2579298231750726
batch time:  1.2348320241241406
batch time:  1.2054971538639316
batch time:  1.5683713498525322
batch time:  1.857265643418456
batch time:  1.5953219409876813
batch time:  1.3581399561371654
batch time:  1.4518609094123045
epoch 17 loss:  -10.986933070466808
epoch 17 time:  14.63739509213095
batch time:  1.458931501613309
batch time:  1.6145206514901171
batch time:  1.333612483367324
batch time:  1.2418824398734918
batch time:  1.4382668941747396
batch time:  1.5540064258500934
batch time:  1.5237781831994652
batch time:  1.718947570088009
batch time:  1.077341118765374
batch time:  0.7470553703295688
epoch 18 loss:  -10.989732073072666
epoch 18 time:  13.708727926357339
batch time:  0.77065326954859
batch time:  0.837498426126937
batch time:  0.8295779502174506
batch time:  0.7966502496041358
batch time:  0.7869069629193594
batch time:  0.7519842432501416
batch time:  0.7907104399365683
batch time:  0.7647710889112205
batch time:  0.7400777900901934
batch time:  0.7431066089775413
epoch 19 loss:  -11.488233972108405
epoch 19 time:  7.812261613473917
batch time:  0.8069393981558581
batch time:  0.7364850714492301
batch time:  0.8356178428822507
batch time:  0.8099635631156464
batch time:  0.7630189642931025
batch time:  0.7385340646530191
batch time:  0.7663169811634968
batch time:  0.7998811664214979
batch time:  0.7514150228196134
batch time:  0.9011280881085744
epoch 20 loss:  -11.952051268419053
epoch 20 time:  7.909721920546144
batch time:  0.7537486755444358
batch time:  0.7344104316551239
batch time:  0.7629264575894922
batch time:  0.7544901463203132
batch time:  0.8126889560526858
batch time:  0.9217297216256459
batch time:  1.430018219118938
batch time:  0.8145667641578863
batch time:  0.8152716665994376
batch time:  0.7681967921555042
epoch 21 loss:  -12.326678171000175
epoch 21 time:  8.568483674448604
batch time:  0.728417161339894
batch time:  0.8429345916335781
batch time:  0.8324112799484282
batch time:  0.7594845376443118
batch time:  0.8351086410538604
batch time:  0.7564182030192266
batch time:  0.7926335354801267
batch time:  0.7594875185284764
batch time:  0.7325550427194685
batch time:  0.7991890419585009
epoch 22 loss:  -12.786751862497905
epoch 22 time:  7.83907795920968
batch time:  0.7909718294627964
batch time:  1.3895668094356854
batch time:  0.9693447770085186
batch time:  0.7823603133050104
batch time:  0.7836412468459457
batch time:  0.8078833136086663
batch time:  0.8158878246632715
batch time:  0.7925317694588254
batch time:  0.7562497521440188
batch time:  0.7919860280739764
epoch 23 loss:  -12.490048865531264
epoch 23 time:  8.680838848960896
batch time:  0.7566892167863747
batch time:  0.7412589940087249
batch time:  0.8146206189567844
batch time:  0.7875546456159402
batch time:  0.782357569752882
batch time:  0.7751616483864685
batch time:  0.7618749953806401
batch time:  0.7682106551869462
batch time:  0.7538770947915813
batch time:  0.809718856572484
epoch 24 loss:  -12.774141773552593
epoch 24 time:  7.7518324240886916
batch time:  0.7551230940967798
batch time:  0.7568281687796116
batch time:  0.7389590666318934
batch time:  0.7658182484097779
batch time:  0.7590362516852717
batch time:  0.7654500018029163
batch time:  0.7921491615008562
batch time:  0.8025923772715032
batch time:  0.7662382621938983
batch time:  0.7753272416380544
epoch 25 loss:  -13.09980087343676
epoch 25 time:  7.677925249375403
batch time:  0.7570540283961843
batch time:  0.792724514255921
batch time:  0.7803344035521149
batch time:  0.773759555288901
batch time:  0.7518360369062672
batch time:  0.774553429428488
batch time:  0.9129889362026006
batch time:  0.7520336466220517
batch time:  0.7327189496563127
batch time:  0.800702137981231
epoch 26 loss:  -13.01988177265381
epoch 26 time:  7.829203171857322
batch time:  0.8125625061336905
batch time:  0.7849885925184935
batch time:  0.7597042596278091
batch time:  0.7440802475127081
batch time:  0.7668913070112466
batch time:  0.7420433051884174
batch time:  0.7223087973271807
batch time:  0.6963922877795994
batch time:  0.680037031803901
batch time:  0.6498554120150705
epoch 27 loss:  -12.72048208851264
epoch 27 time:  7.35928206431369
batch time:  0.6285617793134103
batch time:  0.753617765319844
batch time:  1.3933663408116748
batch time:  1.5190750639109563
batch time:  1.4013827164502193
batch time:  1.3527785528295984
batch time:  1.3889609353927275
batch time:  1.446572404867038
batch time:  1.623828455992043
batch time:  1.4425561300634095
epoch 28 loss:  -13.143751001425786
epoch 28 time:  12.951188287325204
batch time:  1.3487639190939567
batch time:  1.4288697343474874
batch time:  1.3351801545359194
batch time:  1.6213190518940488
batch time:  1.4584091410351296
batch time:  1.5571450516736756
batch time:  1.4622620684249947
batch time:  1.5343530494098863
batch time:  1.3647348314834138
batch time:  1.3706240145955235
epoch 29 loss:  -13.3249573998804
epoch 29 time:  14.482098556589335
encode time:  489.0318661045749

Start sliding the raw time series and the corresponding class and variate label
0
X_slide shape: (41500, 614)
candidates_dim: (41500, 614)
candidates_class_label: (41500, 614)
batch number:  830
count:  0
count:  100
count:  200
count:  300
count:  400
count:  500
count:  600
count:  700
count:  800
representation_all shape: (41500, 320)
1
X_slide shape: (62000, 409)
candidates_dim: (62000, 409)
candidates_class_label: (62000, 409)
batch number:  1240
count:  0
count:  100
count:  200
count:  300
count:  400
count:  500
count:  600
count:  700
count:  800
count:  900
count:  1000
count:  1100
count:  1200
representation_all shape: (103500, 320)
2
X_slide shape: (82500, 204)
candidates_dim: (82500, 204)
candidates_class_label: (82500, 204)
batch number:  1650
count:  0
count:  100
count:  200
count:  300
count:  400
count:  500
count:  600
count:  700
count:  800
count:  900
count:  1000
count:  1100
count:  1200
count:  1300
count:  1400
count:  1500
count:  1600
representation_all shape: (186000, 320)
End sliding
siding time:  3.553493954365452

* All the shapelets info:
(186000, 320)
186000
(186000,)
all subTs num: [41500, 62000, 82500]

Start clustring all the new representations...
End clustring
clustring time: 10.105091050531094

calculate elements number in each cluster
time: 0.36739468574523926

get the nearest index
time: 1.926645040512085

Start scoring all the candidate...
End scoring
discovery time:  13.701102481161554
transformation time:  1.5190301739145071
classification time:  0.0028566953260451555
svm linear Accuracy: 0.7608247422680412
              precision    recall  f1-score   support

           1       0.72      0.84      0.78       458
           2       0.87      0.88      0.87       654
           3       0.65      0.77      0.70       418
           4       0.69      0.54      0.60       581
           5       0.90      0.82      0.86       314

    accuracy                           0.76      2425
   macro avg       0.76      0.77      0.76      2425
weighted avg       0.76      0.76      0.76      2425

All time:  517.1316555553892
