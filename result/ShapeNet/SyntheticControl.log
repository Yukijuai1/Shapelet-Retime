parse arguments succeed !!!
300 1 60
start new network training
train encoder
batch time:  0.17819318437638382
batch time:  0.1818966421453903
batch time:  0.1814661521309366
batch time:  0.17638119872038563
batch time:  0.18560855447625121
batch time:  0.18224867493845523
epoch 0 loss:  31.008203633099377
epoch 0 time:  1.0862398955971002
batch time:  0.1885321628457556
batch time:  0.18858008881409963
batch time:  0.1854041271377355
batch time:  0.191907577139015
batch time:  0.18691795313109955
batch time:  0.19092100916119914
epoch 1 loss:  16.43738168822911
epoch 1 time:  1.1328890829036633
batch time:  0.19323755946631233
batch time:  0.18519867743986348
batch time:  0.19340449150962133
batch time:  0.1871842129000773
batch time:  0.18674544137902557
batch time:  0.1900903195142746
epoch 2 loss:  10.104406805010456
epoch 2 time:  1.1364422183173397
batch time:  0.19712337983461717
batch time:  0.18311272494805356
batch time:  0.1835469382815063
batch time:  0.19705147695106764
batch time:  0.19436087450012565
batch time:  0.19316573763887088
epoch 3 loss:  4.192433247781132
epoch 3 time:  1.148911411765342
batch time:  0.19634770462289453
batch time:  0.18693170351907612
batch time:  0.18335758270695807
batch time:  0.18808263493701816
batch time:  0.19608200020156802
batch time:  0.19040952348150314
epoch 4 loss:  -0.5930176569659391
epoch 4 time:  1.141714863323917
batch time:  0.18476459012987714
batch time:  0.18906220144902666
batch time:  0.18226972785778345
batch time:  0.1887961075330774
batch time:  0.18867574650794267
batch time:  0.1867384083258609
epoch 5 loss:  -1.9203064324165138
epoch 5 time:  1.1208202468696982
batch time:  0.18326254789717494
batch time:  0.18531232274447879
batch time:  0.19635514176140229
batch time:  0.18792845625430346
batch time:  0.19184603877365589
batch time:  0.18210595133714377
epoch 6 loss:  -4.894366492740289
epoch 6 time:  1.1273296924463163
batch time:  0.19599863997039696
batch time:  0.18665917307759325
batch time:  0.19524722419058282
batch time:  0.1975862729518364
batch time:  0.1828535676157723
batch time:  0.19026973890140653
epoch 7 loss:  -6.1367354922668405
epoch 7 time:  1.1491956031570831
batch time:  0.1960192747414112
batch time:  0.18497147389377158
batch time:  0.19590762305694323
batch time:  0.18630022794629136
batch time:  0.18576518873063227
batch time:  0.19318951164993148
epoch 8 loss:  -8.395010163127937
epoch 8 time:  1.1424829087220132
batch time:  0.1855049726863702
batch time:  0.19024596010955672
batch time:  0.18616496711038052
batch time:  0.1910432685787479
batch time:  0.19616380360287924
batch time:  0.1881027585826814
epoch 9 loss:  -9.223801099753043
epoch 9 time:  1.1378991609128812
batch time:  0.19398344114112356
batch time:  0.18976211027863124
batch time:  0.1914075615350157
batch time:  0.19114873119009038
batch time:  0.19057607419478398
batch time:  0.20152606315289934
epoch 10 loss:  -9.100418622082513
epoch 10 time:  1.1590513974117735
batch time:  0.1864354630621771
batch time:  0.19075430218751233
batch time:  0.1899209266062826
batch time:  0.18709845455984275
batch time:  0.18474798050398628
batch time:  0.19647722407244145
epoch 11 loss:  -10.412484702566942
epoch 11 time:  1.1359388307668268
batch time:  0.19046318838372828
batch time:  0.18995233199869593
batch time:  0.18291042023338377
batch time:  0.19435306880623102
batch time:  0.17959462714691957
batch time:  0.1837701359608521
epoch 12 loss:  -11.237262780488647
epoch 12 time:  1.121513512171805
batch time:  0.19034520586331685
batch time:  0.1903045791046073
batch time:  0.23414477437424164
batch time:  0.24428177643567323
batch time:  0.20886527740707
batch time:  0.2184090718316535
epoch 13 loss:  -11.810909664824173
epoch 13 time:  1.2868485677676895
batch time:  0.20345388234903414
batch time:  0.19963670899160207
batch time:  0.20809742696583272
batch time:  0.20760126602835954
batch time:  0.2117075700002412
batch time:  0.2147257782674084
epoch 14 loss:  -12.015475031670068
epoch 14 time:  1.2457016070373357
batch time:  0.21895005909415582
batch time:  0.21225585425272583
batch time:  0.2183091572020203
batch time:  0.2176750907363991
batch time:  0.1997050909480701
batch time:  0.20008547184988856
epoch 15 loss:  -10.951065417819487
epoch 15 time:  1.2674903628261138
batch time:  0.2072831055459877
batch time:  0.2091384796736141
batch time:  0.20990150740059713
batch time:  0.20018800489294034
batch time:  0.18914712735762199
batch time:  0.18959355130791664
epoch 16 loss:  -11.72046016011018
epoch 16 time:  1.205844604301577
batch time:  0.18988208749021093
batch time:  0.18457254255190492
batch time:  0.192742200801149
batch time:  0.2048838703893125
batch time:  0.24718188957000772
batch time:  0.21012821779586374
epoch 17 loss:  -11.834965002850414
epoch 17 time:  1.2299983285212268
batch time:  0.2129593657174458
batch time:  0.20514423884451388
batch time:  0.22190188110495607
batch time:  0.21724141295999289
batch time:  0.20409782143930594
batch time:  0.20187801082308093
epoch 18 loss:  -12.244365575379756
epoch 18 time:  1.2636944106779993
batch time:  0.21035156490591664
batch time:  0.19390609442877274
batch time:  0.21425809762440623
batch time:  0.21901364359073341
batch time:  0.1992037710423271
batch time:  0.1972682918732365
epoch 19 loss:  -11.717523829126499
epoch 19 time:  1.2345340015056232
batch time:  0.20226460861352583
batch time:  0.2016586360676835
batch time:  0.20626816401878992
batch time:  0.2045242342321823
batch time:  0.20374741554260253
batch time:  0.2124927168401579
epoch 20 loss:  -11.574660783249819
epoch 20 time:  1.231444430941095
batch time:  0.2034131098538637
batch time:  0.21800564704462885
batch time:  0.20741719026118516
batch time:  0.2144754533500721
batch time:  0.20970948532534142
batch time:  0.21725317472591996
epoch 21 loss:  -10.859820125849872
epoch 21 time:  1.270819519351547
batch time:  0.20766496133680146
batch time:  0.19661256784262757
batch time:  0.18805266465060413
batch time:  0.1850122396989415
batch time:  0.18810490230098367
batch time:  0.18764478565814594
epoch 22 loss:  -9.092444447612374
epoch 22 time:  1.1536093468622615
batch time:  0.18253183346241714
batch time:  0.1864362628975262
batch time:  0.21723207243097326
batch time:  0.2604461611248553
batch time:  0.2620011920419832
batch time:  0.2106274832505733
epoch 23 loss:  -11.595520505449802
epoch 23 time:  1.319757501843075
batch time:  0.21209441376850008
batch time:  0.204311215536048
batch time:  0.2145982316074272
batch time:  0.21506888122918705
batch time:  0.20526059713835518
batch time:  0.20329268669399123
epoch 24 loss:  -12.524401433815648
epoch 24 time:  1.2551503252082814
batch time:  0.20467068765622873
batch time:  0.21632488848020634
batch time:  0.20944662277276319
batch time:  0.19840202134413024
batch time:  0.2152298586287846
batch time:  0.198534731939435
epoch 25 loss:  -12.184565944022363
epoch 25 time:  1.243099705611045
batch time:  0.2137075438008954
batch time:  0.20043541129368048
batch time:  0.19995848474403222
batch time:  0.21122907657797138
batch time:  0.21065114185524483
batch time:  0.20259127200891575
epoch 26 loss:  -12.373632738110416
epoch 26 time:  1.2392323987403264
batch time:  0.2134801424884548
batch time:  0.20206855710906288
batch time:  0.21501704432691138
batch time:  0.20929369300914308
batch time:  0.20766008344168466
batch time:  0.20183898690156638
epoch 27 loss:  -12.507461860161351
epoch 27 time:  1.2499798570293934
batch time:  0.20041264689837893
batch time:  0.20204798312236866
batch time:  0.2112254797015339
batch time:  0.20728522076581915
batch time:  0.20708597468522688
batch time:  0.207061280325676
epoch 28 loss:  -12.714200101445432
epoch 28 time:  1.2356862425338477
batch time:  0.20936248603587349
batch time:  0.2043142442125827
batch time:  0.20523233170000216
batch time:  0.21403233297169208
batch time:  0.20206193015910684
batch time:  0.21966982018202544
epoch 29 loss:  -12.346691746097813
epoch 29 time:  1.2551487379086514
encode time:  35.93617352425742

Start sliding the raw time series and the corresponding class and variate label
0
X_slide shape: (3900, 36)
candidates_dim: (3900, 36)
candidates_class_label: (3900, 36)
batch number:  78
count:  0
representation_all shape: (3900, 320)
1
X_slide shape: (5700, 24)
candidates_dim: (5700, 24)
candidates_class_label: (5700, 24)
batch number:  114
count:  0
count:  100
representation_all shape: (9600, 320)
2
X_slide shape: (7500, 12)
candidates_dim: (7500, 12)
candidates_class_label: (7500, 12)
batch number:  150
count:  0
count:  100
representation_all shape: (17100, 320)
End sliding
siding time:  0.11939676441252231

* All the shapelets info:
(17100, 320)
17100
(17100,)
all subTs num: [3900, 5700, 7500]

Start clustring all the new representations...
End clustring
clustring time: 1.082108633965254

calculate elements number in each cluster
time: 0.2826662063598633

get the nearest index
time: 0.1248781681060791

Start scoring all the candidate...
End scoring
discovery time:  1.2108797555013249
transformation time:  0.030093814727539817
classification time:  5.777799524366856e-05
svm linear Accuracy: 0.64
              precision    recall  f1-score   support

           1       0.67      0.92      0.77        50
           2       0.79      0.68      0.73        50
           3       0.75      0.72      0.73        50
           4       0.57      0.68      0.62        50
           5       0.55      0.44      0.49        50
           6       0.50      0.40      0.44        50

    accuracy                           0.64       300
   macro avg       0.64      0.64      0.63       300
weighted avg       0.64      0.64      0.63       300

All time:  37.26243650338923
